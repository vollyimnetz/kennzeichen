import{p as ie,l as V,h as De,aD as Fe,i as Ie,Q as Re,j as Ve,k as Ae,e as A,m as W,r as _,s as Te,M as se,n as $e,a as w,F as J,v as Pe,g as Ee,y as je,z as ze,aE as te,_ as Le,c as Ne,w as E,V as ne,b as x,d as K,H as Q,t as xe,E as Oe,o as O}from"./index-B6QETzm4.js";import{V as ae}from"./VAlert-Dgyt9xAk.js";import{u as Ge,V as re,a as le,f as Me,m as Ue,b as qe,c as He}from"./forwardRefs-D50KAhW3.js";import{V as We}from"./VChip-WGfWN0_W.js";function _e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var G={exports:{}},Je=G.exports,oe;function Ke(){return oe||(oe=1,(function(e,n){(function(l,o){e.exports=o()})(Je,function(){return function l(o,r,a){var c=window,i="application/octet-stream",m=a||i,s=o,b=!r&&!a&&s,p=document.createElement("a"),T=function(u){return String(u)},v=c.Blob||c.MozBlob||c.WebKitBlob||T,g=r||"download",y,$;if(v=v.call?v.bind(c):Blob,String(this)==="true"&&(s=[s,m],m=s[0],s=s[1]),b&&b.length<2048&&(g=b.split("/").pop().split("?")[0],p.href=b,p.href.indexOf(b)!==-1)){var k=new XMLHttpRequest;return k.open("GET",b,!0),k.responseType="blob",k.onload=function(u){l(u.target.response,g,i)},setTimeout(function(){k.send()},0),k}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(s))if(s.length>1024*1024*1.999&&v!==T)s=B(s),m=s.type||i;else return navigator.msSaveBlob?navigator.msSaveBlob(B(s),g):C(s);else if(/([\x80-\xff])/.test(s)){var d=0,P=new Uint8Array(s.length),j=P.length;for(d;d<j;++d)P[d]=s.charCodeAt(d);s=new v([P],{type:m})}y=s instanceof v?s:new v([s],{type:m});function B(u){var h=u.split(/[:;,]/),S=h[1],M=h[2]=="base64"?atob:decodeURIComponent,z=M(h.pop()),L=z.length,D=0,N=new Uint8Array(L);for(D;D<L;++D)N[D]=z.charCodeAt(D);return new v([N],{type:S})}function C(u,h){if("download"in p)return p.href=u,p.setAttribute("download",g),p.className="download-js-link",p.innerHTML="downloading...",p.style.display="none",document.body.appendChild(p),setTimeout(function(){p.click(),document.body.removeChild(p),h===!0&&setTimeout(function(){c.URL.revokeObjectURL(p.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(u)&&(u="data:"+u.replace(/^data:([\w\/\-\+]+)/,i)),window.open(u)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=u),!0;var S=document.createElement("iframe");document.body.appendChild(S),!h&&/^data:/.test(u)&&(u="data:"+u.replace(/^data:([\w\/\-\+]+)/,i)),S.src=u,setTimeout(function(){document.body.removeChild(S)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(y,g);if(c.URL)C(c.URL.createObjectURL(y),!0);else{if(typeof y=="string"||y.constructor===T)try{return C("data:"+m+";base64,"+c.btoa(y))}catch{return C("data:"+m+","+encodeURIComponent(y))}$=new FileReader,$.onload=function(u){C(this.result)},$.readAsDataURL(y)}return!0}})})(G)),G.exports}var Qe=Ke();const Xe=_e(Qe);function Ye(){function e(l){return[...l.dataTransfer?.items??[]].filter(r=>r.kind==="file").map(r=>r.webkitGetAsEntry()).filter(Boolean).length>0||[...l.dataTransfer?.files??[]].length>0}async function n(l){const o=[],r=[...l.dataTransfer?.items??[]].filter(a=>a.kind==="file").map(a=>a.webkitGetAsEntry()).filter(Boolean);if(r.length)for(const a of r){const c=await ue(a,ce(".",a));o.push(...c.map(i=>i.file))}else o.push(...l.dataTransfer?.files??[]);return o}return{handleDrop:n,hasFilesOrFolders:e}}function ue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new Promise((l,o)=>{e.isFile?e.file(a=>l([{file:a,path:n}]),o):e.isDirectory&&e.createReader().readEntries(async a=>{const c=[];for(const i of a)c.push(...await ue(i,ce(n,i)));l(c)})})}function ce(e,n){return n.isDirectory?`${e}/${n.name}`:e}const Ze=ie({filterByType:String},"file-accept");function et(e){const n=V(()=>e.filterByType?tt(e.filterByType):null);function l(o){if(n.value){const r=o.filter(n.value);return{accepted:r,rejected:o.filter(a=>!r.includes(a))}}return{accepted:o,rejected:[]}}return{filterAccepted:l}}function tt(e){const n=e.split(",").map(a=>a.trim().toLowerCase()),l=n.filter(a=>a.startsWith(".")),o=n.filter(a=>a.endsWith("/*")),r=n.filter(a=>!l.includes(a)&&!o.includes(a));return a=>{const c=a.name.split(".").at(-1)?.toLowerCase()??"",i=a.type.split("/").at(0)?.toLowerCase()??"";return r.includes(a.type)||l.includes(`.${c}`)||o.includes(`${i}/*`)}}const nt=ie({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},truncateLength:{type:[Number,String],default:22},...$e(qe({prependIcon:"$file"}),["direction"]),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>se(e).every(n=>n!=null&&typeof n=="object")},...Ze(),...Ue({clearable:!0})},"VFileInput"),at=De()({name:"VFileInput",inheritAttrs:!1,props:nt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,rejected:e=>!0},setup(e,n){let{attrs:l,emit:o,slots:r}=n;const{t:a}=Fe(),{filterAccepted:c}=et(e),i=Ie(e,"modelValue",e.modelValue,t=>se(t),t=>!e.multiple&&Array.isArray(t)?t[0]:t),{isFocused:m,focus:s,blur:b}=Ge(e),p=V(()=>typeof e.showSize!="boolean"?e.showSize:void 0),T=V(()=>(i.value??[]).reduce((t,f)=>{let{size:F=0}=f;return t+F},0)),v=V(()=>te(T.value,p.value)),g=V(()=>(i.value??[]).map(t=>{const{name:f="",size:F=0}=t,I=D(f);return e.showSize?`${I} (${te(F,p.value)})`:I})),y=V(()=>{const t=i.value?.length??0;return e.showSize?a(e.counterSizeString,t,v.value):a(e.counterString,t)}),$=_(),k=_(),d=_(),P=Ee(()=>m.value||e.active),j=V(()=>["plain","underlined"].includes(e.variant)),B=Te(!1),{handleDrop:C,hasFilesOrFolders:u}=Ye();function h(){d.value!==document.activeElement&&d.value?.focus(),m.value||s()}function S(t){d.value?.click()}function M(t){o("mousedown:control",t)}function z(t){d.value?.click(),o("click:control",t)}function L(t){t.stopPropagation(),h(),je(()=>{i.value=[],ze(e["onClick:clear"],t)})}function D(t){if(t.length<Number(e.truncateLength))return t;const f=Math.floor((Number(e.truncateLength)-1)/2);return`${t.slice(0,f)}…${t.slice(t.length-f)}`}function N(t){t.preventDefault(),t.stopImmediatePropagation(),B.value=!0}function de(t){t.preventDefault(),B.value=!1}async function fe(t){if(t.preventDefault(),t.stopImmediatePropagation(),B.value=!1,!d.value||!u(t))return;const f=await C(t);X(f)}function pe(t){if(!(!t.target||t.repack))if(e.filterByType)X([...t.target.files]);else{const f=t.target;i.value=[...f.files??[]]}}function X(t){const f=new DataTransfer,{accepted:F,rejected:I}=c(t);I.length&&o("rejected",I);for(const q of F)f.items.add(q);d.value.files=f.files,i.value=[...f.files];const U=new Event("change",{bubbles:!0});U.repack=!0,d.value.dispatchEvent(U)}return Re(i,t=>{(!Array.isArray(t)||!t.length)&&d.value&&(d.value.value="")}),Ve(()=>{const t=!!(r.counter||e.counter),f=!!(t||r.details),[F,I]=Ae(l),{modelValue:U,...q}=re.filterProps(e),me={...le.filterProps(e),"onClick:clear":L},ve=l.webkitdirectory!==void 0&&l.webkitdirectory!==!1,ye=l.accept?String(l.accept):void 0,he=ve?void 0:e.filterByType??ye;return A(re,W({ref:$,modelValue:e.multiple?i.value:i.value[0],class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--dragging":B.value,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":j.value},e.class],style:e.style,"onClick:prepend":S},F,q,{centerAffix:!j.value,focused:m.value}),{...r,default:H=>{let{id:ge,isDisabled:Y,isDirty:Z,isReadonly:ee,isValid:be,hasDetails:ke}=H;return A(le,W({ref:k,prependIcon:e.prependIcon,onMousedown:M,onClick:z,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},me,{id:ge.value,active:P.value||Z.value,dirty:Z.value||e.dirty,disabled:Y.value,focused:m.value,details:ke.value,error:be.value===!1,onDragover:N,onDrop:fe}),{...r,default:we=>{let{props:{class:Be,...Ce},controlRef:Se}=we;return w(J,null,[w("input",W({ref:R=>d.value=Se.value=R,type:"file",accept:he,readonly:ee.value,disabled:Y.value,multiple:e.multiple,name:e.name,onClick:R=>{R.stopPropagation(),ee.value&&R.preventDefault(),h()},onChange:pe,onDragleave:de,onFocus:h,onBlur:b},Ce,I),null),w("div",{class:Pe(Be)},[!!i.value?.length&&!e.hideInput&&(r.selection?r.selection({fileNames:g.value,totalBytes:T.value,totalBytesReadable:v.value}):e.chips?g.value.map(R=>A(We,{key:R,size:"small",text:R},null)):g.value.join(", "))])])}})},details:f?H=>w(J,null,[r.details?.(H),t&&w(J,null,[w("span",null,null),A(He,{active:!!i.value?.length,value:y.value,disabled:e.disabled},r.counter)])]):void 0})}),Me({},$,k,d)}}),rt={components:{},data:()=>({backupCompleted:!1,error:null}),methods:{async createBackup(){let e={collectGame:await this.$store.dispatch("collectGame/getBackup"),numberGame:await this.$store.dispatch("numberGame/getBackup")};Xe(JSON.stringify(e,null,2),"kennzeichen_backup_"+new Date().toISOString()+".json","application/json")},async restoreBackup(e){const n=e.target.files[0];if(!n)return;const l=new FileReader;l.onload=async o=>{try{const r=JSON.parse(o.target.result);console.log("imported backup data:",r),await this.$store.dispatch("collectGame/restoreBackup",r.collectGame),await this.$store.dispatch("numberGame/restoreBackup",r.numberGame),this.backupCompleted=!0}catch(r){this.error="Fehler beim Wiederherstellen des Backups: "+r.message}},l.readAsText(n)}}},lt={class:"backup"};function ot(e,n,l,o,r,a){return O(),Ne("div",lt,[n[4]||(n[4]=w("h1",null,"Backup",-1)),n[5]||(n[5]=w("p",null,"Hier können Sie ein Backup Ihrer Daten erstellen oder ein bestehendes Backup wiederherstellen.",-1)),A(Oe,{class:"mt-10 d-flex flex-column justify-center align-center ga-3"},{default:E(()=>[A(ne,{color:"primary",onClick:a.createBackup},{default:E(()=>[...n[1]||(n[1]=[x("Backup erstellen",-1)])]),_:1},8,["onClick"]),e.backupCompleted?(O(),K(ae,{key:0,type:"success"},{default:E(()=>[...n[2]||(n[2]=[x("Backup erfolgreich wiederhergestellt!",-1)])]),_:1})):Q("",!0),e.error?(O(),K(ae,{key:1,type:"error"},{default:E(()=>[x(xe(e.error),1)]),_:1})):Q("",!0),e.backupCompleted?Q("",!0):(O(),K(ne,{key:2,color:"secondary",onClick:n[0]||(n[0]=c=>e.$refs.fileInput.$el.querySelector("input").click())},{default:E(()=>[...n[3]||(n[3]=[x("Backup wiederherstellen",-1)])]),_:1})),A(at,{ref:"fileInput",class:"d-none",label:"Backup wiederherstellen",accept:".json,application/json",onChange:a.restoreBackup},null,8,["onChange"])]),_:1})])}const dt=Le(rt,[["render",ot]]);export{dt as default};
